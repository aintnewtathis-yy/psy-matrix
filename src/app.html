<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="%sveltekit.assets%/favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">%sveltekit.body%</div>
	</body>
	<script src="https://securepay.tinkoff.ru/html/payForm/js/tinkoff_v2.js"></script>
	<script type="text/javascript">
		const TPF = document.getElementById("payform-tinkoff");
	
		TPF.addEventListener("submit", function (e) {
			e.preventDefault();
			const {description, amount, email, phone, receipt} = TPF;
	
			if (receipt) {
				if (!email.value && !phone.value)
					return alert("Поле E-mail или Phone не должно быть пустым");
	
				TPF.receipt.value = JSON.stringify({
					"EmailCompany": "mail@mail.com",
					"Taxation": "patent",
					"FfdVersion": "1.2",
					"Items": [
						{
							"Name": description.value || "Оплата",
							"Price": amount.value + '00',
							"Quantity": 1.00,
							"Amount": amount.value + '00',
							"PaymentMethod": "full_prepayment",
							"PaymentObject": "service",
							"Tax": "none",
							"MeasurementUnit": "pc"
						}
					]
				});
			}
			pay(TPF);
		})
	</script>
	
</html>

